<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>One sample Z-tests • distributions</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="One sample Z-tests">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">distributions</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/intro-to-hypothesis-testing.html">Intro to hypothesis testing</a>
    </li>
    <li>
      <a href="../articles/one-sample-sign-tests.html">One sample sign tests</a>
    </li>
    <li>
      <a href="../articles/one-sample-t-confidence-interval.html">T confidence interval for a mean</a>
    </li>
    <li>
      <a href="../articles/one-sample-t-test.html">One sample T-tests</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-confidence-interval.html">Z confidence interval for a mean</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-test-for-proportion.html">One sample Z-tests for a proportion</a>
    </li>
    <li>
      <a href="../articles/one-sample-z-test.html">One sample Z-tests</a>
    </li>
    <li>
      <a href="../articles/paired-tests.html">Paired tests</a>
    </li>
    <li>
      <a href="../articles/two-sample-z-test.html">Two sample Z-tests</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/alexpghayes/distributions">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>One sample Z-tests</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/alexpghayes/distributions/blob/master/vignettes/one-sample-z-test.Rmd"><code>vignettes/one-sample-z-test.Rmd</code></a></small>
      <div class="hidden name"><code>one-sample-z-test.Rmd</code></div>

    </div>

    
    
<p>In this vignette, we work through an example Z-test, and point out a number of points where you might get stuck along the way.</p>
<div id="problem-setup" class="section level2">
<h2 class="hasAnchor">
<a href="#problem-setup" class="anchor"></a>Problem setup</h2>
<p>Let’s suppose that a student is interesting in estimating how many memes their professors know and love. So they go to class, and every time a professor uses a new meme, they write it down. After a year of classes, the student has recorded the following meme counts, where each count corresponds to a single class they took:</p>
<p><span class="math display">\[
  3, 7, 11, 0, 7, 0, 4, 5, 6, 2
\]</span></p>
<p>The student talks to some other students who’ve done similar studies and determines that <span class="math inline">\(\sigma = 2\)</span> is a reasonable value for the standard deviation of this distribution.</p>
</div>
<div id="assumption-checking" class="section level2">
<h2 class="hasAnchor">
<a href="#assumption-checking" class="anchor"></a>Assumption checking</h2>
<p>Before we can do a Z-test, we need to make check if we can reasonably treat the mean of this sample as normally distributed. This happens is the case of either of following hold:</p>
<ol style="list-style-type: decimal">
<li>The data comes from a normal distribution.</li>
<li>We have lots of data. How much? Many textbooks use 30 data points as a rule of thumb.</li>
</ol>
<p>Since we have a small sample, we let’s check if the data comes from a normal distribution using a normal quantile-quantile plot.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="co"># read in the data</span></a>
<a class="sourceLine" id="cb1-2" data-line-number="2">x &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">0</span>, <span class="dv">7</span>, <span class="dv">0</span>, <span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"></a>
<a class="sourceLine" id="cb1-4" data-line-number="4"><span class="co"># make the qqplot</span></a>
<a class="sourceLine" id="cb1-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/qqnorm">qqnorm</a></span>(x)</a>
<a class="sourceLine" id="cb1-6" data-line-number="6"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/qqnorm">qqline</a></span>(x)</a></code></pre></div>
<p><img src="one-sample-z-test_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<p>Since the data lies close the line <span class="math inline">\(y = x\)</span>, and has no notable systematic deviations from line, it’s safe to treat the sample as coming from a normal distribution. We can proceed with our hypothesis test.</p>
</div>
<div id="null-hypothesis-and-test-statistic" class="section level2">
<h2 class="hasAnchor">
<a href="#null-hypothesis-and-test-statistic" class="anchor"></a>Null hypothesis and test statistic</h2>
<p>Let’s test the null hypothesis that, on average, professors know 3 memes. That is</p>
<p><span class="math display">\[
  H_0: \mu = 3 \qquad H_A: \mu \neq 3
\]</span></p>
<p>First we need to calculate our Z-statistic. Let’s use do this with R. Remember that the Z-statistic is defined as</p>
<p><span class="math display">\[
  Z = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}} \sim \mathrm{Normal}(0, 1)
\]</span></p>
</div>
<div id="calculating-p-values" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-p-values" class="anchor"></a>Calculating p-values</h2>
<p>In R this looks like:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">n &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(x)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"></a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co"># calculate the z-statistic</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">z_stat &lt;-<span class="st"> </span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(x) <span class="op">-</span><span class="st"> </span><span class="dv">3</span>) <span class="op">/</span><span class="st"> </span>(<span class="dv">2</span> <span class="op">/</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">sqrt</a></span>(n))</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">z_stat</a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; [1] 2.371708</span></a></code></pre></div>
<p>To calculate a two-sided p-value, we need to find</p>

<p>To do this we need to c.d.f. of a standard normal</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(distributions)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2"></a>
<a class="sourceLine" id="cb3-3" data-line-number="3">Z &lt;-<span class="st"> </span><span class="kw"><a href="../reference/normal.html">Normal</a></span>(<span class="dv">0</span>, <span class="dv">1</span>)  <span class="co"># make a standard normal r.v.</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="fl">2.37</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="fl">-2.37</span>)</a>
<a class="sourceLine" id="cb3-5" data-line-number="5"><span class="co">#&gt; [1] 0.01778809</span></a></code></pre></div>
<p>Note that we saved <code>z_stat</code> above so we could have also done</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(z_stat)) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="op">-</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/MathFun">abs</a></span>(z_stat))</a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="co">#&gt; [1] 0.01770607</span></a></code></pre></div>
<p>which is slightly more accurate since there is no rounding error.</p>
<p>So our p-value is about 0.0177. You should verify this with a Z-table. Note that you should get the <em>same</em> value from <code><a href="../reference/cdf.html">cdf(Z, 2.37)</a></code> and looking up <code>2.37</code> on a Z-table.</p>
<p>You may also have seen a different formula for the p-value of a two-sided Z-test, which makes use of the fact that the normal distribution is symmetric:</p>

<p>Using this formula we get the same result:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="fl">-2.37</span>)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; [1] 0.01778809</span></a></code></pre></div>
<p>Finally, sometimes we are interest in one sided Z-tests. For the test</p>

<p>the p-value is given by</p>
<p><span class="math display">\[
  P(Z &gt; 2.37)
\]</span></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="fl">2.37</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] 0.008894043</span></a></code></pre></div>
<p>For the test</p>
<p><span class="math display">\[
  H_0: \mu \ge 3 \qquad H_A: \mu &lt; 3
\]</span></p>
<p>the p-value is given by</p>
<p><span class="math display">\[
  P(Z &lt; 2.37)
\]</span></p>
<p>which we calculate with</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="../reference/cdf.html">cdf</a></span>(Z, <span class="fl">2.37</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2"><span class="co">#&gt; [1] 0.991106</span></a></code></pre></div>
</div>
<div id="rejection-regions" class="section level2">
<h2 class="hasAnchor">
<a href="#rejection-regions" class="anchor"></a>Rejection regions</h2>
<p><strong>Preface</strong>: I am strongly opposed to make a dichotomous “reject/fail to reject” decision for hypothesis tests. If you do a hypothesis test, you should report the p-value, period. Picking an arbitrary <span class="math inline">\(\alpha\)</span> level rejection threshold and treating it as a gold standard is ridiculous, as evidenced by 60 years of statistical literature laden with warnings about hypothesis testing. That said, sometimes it can be useful to think about when you reject a hypothesis test.</p>
<p>We can think about three different rejection regions for a Z-test:</p>
<ol style="list-style-type: decimal">
<li>The rejection region in terms of the p-value</li>
<li>The rejection region in terms of the test statistic</li>
<li>The rejection region in terms of the sample mean</li>
</ol>
<p>For a given <span class="math inline">\(\alpha\)</span> level threshold, all of these rejection regions are equivalent. We’ll start by thinking about the rejection of a two-sided test. That is</p>

<p>We then calculate a test statistic <span class="math inline">\(Z_\text{obs}\)</span>, and a p-value <span class="math inline">\(P(|Z| &gt; |Z_\text{obs}|)\)</span> and reject when <span class="math inline">\(P(|Z| &gt; |Z_\text{obs}|) &lt; \alpha\)</span>. This defines our first rejection region. Using our observation from before, this is exactly equivalent to rejecting when</p>

<p>and this last statement is exactly the same as when <span class="math inline">\(Z_\text{obs} &lt; z_{\alpha / 2}\)</span> or <span class="math inline">\(z_{1 - \alpha / 2} &lt; Z_\text{obs}\)</span>. This is our second region region, in terms of the test statistic. Finally, recall that</p>
<p><span class="math display">\[
  Z_\text{obs} = \frac{\bar x - \mu_0}{\sigma / \sqrt{n}}
\]</span></p>
<p>So we take the conditions and rearrange to in terms of <span class="math inline">\(\bar x\)</span></p>

<p>and</p>

<p>You can also think about this in terms of <span class="math inline">\(\mu_0\)</span>. We will reject the test when <span class="math inline">\(\mu_0\)</span> is not in</p>

<p>which you may recognize as the confidence interval for <span class="math inline">\(\mu\)</span>! So the confidence interval contains all the values of <span class="math inline">\(\mu_0\)</span> that we cannot reject at the <span class="math inline">\(\alpha\)</span> level. You can perform a similar calculation for a one sided test, resulting in a one-sided confidence bound, where one end of the interval is either <span class="math inline">\(\infty\)</span> or <span class="math inline">\(-\infty\)</span>.</p>
</div>
<div id="power" class="section level2">
<h2 class="hasAnchor">
<a href="#power" class="anchor"></a>Power</h2>
<p>TODO</p>
<div id="formulas-for-power" class="section level3">
<h3 class="hasAnchor">
<a href="#formulas-for-power" class="anchor"></a>Formulas for power</h3>
<p>TODO: power formula in terms of test statistics</p>
<p>To achieve a power of <span class="math inline">\(1 - \beta\)</span> for a (two-sided) one sample Z-test, you need</p>
<p><span class="math display">\[
  n \approx \left(
    {
      \sigma \cdot (z_{\alpha / 2} + z_\beta) \over
      \mu_0 - \mu_A
    }
  \right)^2
\]</span></p>
<p>round up</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#problem-setup">Problem setup</a></li>
      <li><a href="#assumption-checking">Assumption checking</a></li>
      <li><a href="#null-hypothesis-and-test-statistic">Null hypothesis and test statistic</a></li>
      <li><a href="#calculating-p-values">Calculating p-values</a></li>
      <li><a href="#rejection-regions">Rejection regions</a></li>
      <li><a href="#power">Power</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alex Hayes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
